
R version 2.11.1 (2010-05-31)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Dennis Schnabel example
> 
> library("nleqslv")
>     
> dslnex <- function(x) {
+     y <- numeric(2)
+     y[1] <- x[1]^2 + x[2]^2 - 2
+     y[2] <- exp(x[1]-1) + x[2]^3 - 2
+     y
+ }
> 
> jacdsln <- function(x) {
+     n <- length(x)
+     Df <- matrix(numeric(n*n),n,n)
+     Df[1,1] <- 2*x[1]
+     Df[1,2] <- 2*x[2]
+     Df[2,1] <- exp(x[1]-1)
+     Df[2,2] <- 3*x[2]^2
+ 
+     Df
+ }
> 
> xstart <- c(2,0.5)
> fstart <- dslnex(xstart)
> xstart
[1] 2.0 0.5
> fstart
[1] 2.2500000 0.8432818
> 
> # a solution is c(1,1)
> znleqa <- nleqslv(xstart, dslnex, global="qline",xscalm="auto",control=list(trace=1,btol=.01))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: quadratic linesearch
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac   Lambda          Ftarg         Fnorm   Largest |f|
     0                                      2.886812e+00  2.250000e+00
     1  N(2.2e-02)   1.0000   2.886235e+00  5.787362e+05  1.070841e+03
     1               0.1000   2.886754e+00  9.857947e+00  3.214799e+00
     1               0.0100   2.886806e+00  2.866321e+00  2.237878e+00
     2  B(4.3e-02)   1.0000   2.865748e+00  2.433820e+03  6.811807e+01
     2               0.1000   2.866264e+00  3.022236e+00  2.192558e+00
     2               0.0393   2.866299e+00  2.773419e+00  2.184806e+00
     3  B(8.2e-02)   1.0000   2.772864e+00  6.360262e-01  8.927138e-01
     4  B(1.2e-01)   1.0000   6.358990e-01  2.558314e-01  6.528056e-01
     5  B(2.1e-01)   1.0000   2.557803e-01  2.205306e-01  6.024684e-01
     6  B(2.6e-02)   1.0000   2.204865e-01  5.577039e+03  1.036431e+02
     6               0.1000   2.205262e-01  1.012734e-02  1.148614e-01
     7  B(1.7e-01)   1.0000   1.012532e-02  7.720575e-03  1.174039e-01
     8  B(3.8e-02)   1.0000   7.719031e-03  9.988121e-03  1.292276e-01
     8               0.4360   7.719902e-03  1.522836e-04  1.742086e-02
     9  B(6.1e-02)   1.0000   1.522532e-04  8.091650e-07  1.148991e-03
    10  B(6.3e-02)   1.0000   8.090031e-07  2.331930e-09  6.387588e-05
    11  B(7.0e-02)   1.0000   2.331463e-09  1.684561e-12  1.727583e-06
    12  B(6.7e-02)   1.0000   1.684224e-12  3.039744e-17  7.340434e-09
> znleqa
$x
[1] 1 1

$fvec
[1] -2.629241e-09 -7.340434e-09

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 18

$njcnt
[1] 1

> 
> znleqb <- nleqslv(xstart, dslnex, global="gline",xscalm="auto",control=list(trace=1,btol=.01))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: geometric linesearch (reduction = 0.5)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac   Lambda          Ftarg         Fnorm   Largest |f|
     0                                      2.886812e+00  2.250000e+00
     1  N(2.2e-02)   1.0000   2.886235e+00  5.787362e+05  1.070841e+03
     1               0.5000   2.886523e+00  1.211981e+04  1.533192e+02
     1               0.2500   2.886668e+00  3.346737e+02  2.454656e+01
     1               0.1250   2.886740e+00  1.860606e+01  4.931671e+00
     1               0.0625   2.886776e+00  4.468205e+00  2.514779e+00
     1               0.0312   2.886794e+00  3.097106e+00  2.281039e+00
     1               0.0156   2.886803e+00  2.888770e+00  2.240182e+00
     1               0.0078   2.886808e+00  2.864341e+00  2.238756e+00
     2  B(3.9e-02)   1.0000   2.863768e+00  6.779790e+03  1.143812e+02
     2               0.5000   2.864054e+00  2.096989e+02  1.936789e+01
     2               0.2500   2.864197e+00  1.370952e+01  4.218771e+00
     2               0.1250   2.864269e+00  3.874367e+00  2.334050e+00
     2               0.0625   2.864305e+00  2.909871e+00  2.202349e+00
     2               0.0312   2.864323e+00  2.800370e+00  2.199539e+00
     3  B(7.6e-02)   1.0000   2.799810e+00  3.046830e+00  2.148077e+00
     3               0.5000   2.800090e+00  1.346777e+00  1.374851e+00
     4  B(1.2e-01)   1.0000   1.346507e+00  2.020951e-01  6.070527e-01
     5  B(7.1e-02)   1.0000   2.020547e-01  2.778544e-01  6.111032e-01
     5               0.5000   2.020749e-01  9.050555e-02  4.168096e-01
     6  B(3.4e-02)   1.0000   9.048745e-02  4.550839e+01  9.009249e+00
     6               0.5000   9.049650e-02  2.407547e+00  1.986715e+00
     6               0.2500   9.050102e-02  9.808403e-02  3.476188e-01
     6               0.1250   9.050329e-02  9.640294e-03  1.264414e-01
     7  B(9.7e-02)   1.0000   9.638366e-03  5.364159e-04  2.548245e-02
     8  B(1.1e-01)   1.0000   5.363086e-04  1.696385e-04  1.719944e-02
     9  B(1.2e-01)   1.0000   1.696046e-04  1.148715e-05  4.534894e-03
    10  B(7.6e-02)   1.0000   1.148486e-05  1.161792e-09  4.641950e-05
    11  B(7.5e-02)   1.0000   1.161560e-09  3.676055e-13  8.146372e-07
    12  B(7.2e-02)   1.0000   3.675320e-13  7.150909e-17  1.131568e-08
    13  B(7.4e-02)   1.0000   7.149479e-17  1.249241e-21  4.729861e-11
> znleqb
$x
[1] 1 1

$fvec
[1] -1.616551e-11 -4.729861e-11

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 30

$njcnt
[1] 1

> 
> znleqc <- nleqslv(xstart, dslnex, global="dbldog",xscalm="auto",
+                     control=list(trace=1,btol=.01,delta=-1.0))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: double dogleg (initial trust region = -1)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda    Gamma      Eta     Dlt0     Dltn         Fnorm   Largest |f|
     0                                                             2.886812e+00  2.250000e+00
     1  N(2.2e-02) C            0.9332   0.9465   1.6418   3.2836  8.095340e-01  1.271042e+00
     2  B(3.9e-02) W   0.1788   0.6549   0.7240   3.2836   6.5672  3.416215e-01  7.035984e-01
     3  B(1.1e-01) N            0.8312   0.8649   2.9936   0.2994  2.837333e+02  2.270050e+01
     3             C            0.8312   0.8649   0.2994   0.5987  1.352076e-01  4.965309e-01
     4  B(9.0e-02) W   0.2606   0.6553   0.7243   0.5987   0.0923  5.436294e-01  7.379611e-01
     4             C            0.6553   0.7243   0.0923   0.1846  8.813219e-02  4.157850e-01
     5  B(8.0e-02) C            0.5536   0.6429   0.1846   0.3692  3.647684e-02  2.245534e-01
     5             W   0.2009   0.5536   0.6429   0.3692   0.1846  3.647684e-02  2.245534e-01
     6  B(7.4e-02) W   0.3661   0.0385   0.2308   0.1846   0.0225  6.118715e-02  3.443443e-01
     6             C            0.0385   0.2308   0.0225   0.0449  3.451900e-02  1.901861e-01
     7  B(7.4e-02) C            0.0371   0.2296   0.0449   0.0224  3.451961e-02  2.339185e-01
     7             C            0.0371   0.2296   0.0224   0.0449  3.360691e-02  2.072954e-01
     8  B(6.0e-02) W   0.1155   0.0265   0.2212   0.0449   0.0898  3.097654e-02  1.986844e-01
     8             W   0.3080   0.0265   0.2212   0.0898   0.1796  2.960976e-02  2.150600e-01
     9  B(6.0e-02) W   0.7109   0.0624   0.2499   0.1796   0.3592  2.026901e-02  1.807498e-01
    10  B(6.0e-02) P            0.0736   0.2589   0.3592   0.7183  7.271921e-03  1.163481e-01
    10             P            0.0736   0.2589   0.7183   1.4366  3.514785e-03  6.857360e-02
    11  B(6.2e-02) N            0.9349   0.9479   0.0938   0.1877  3.775664e-05  7.609824e-03
    12  B(4.1e-02) N            0.0396   0.2317   0.0549   0.0549  1.421871e-05  5.223679e-03
    13  B(6.1e-02) N            0.4071   0.5257   0.0179   0.0359  5.978272e-08  3.425616e-04
    14  B(6.6e-02) N            0.4732   0.5785   0.0010   0.0021  2.704024e-12  2.069442e-06
    15  B(6.6e-02) N            0.0607   0.2486   0.0000   0.0000  4.034725e-14  2.726626e-07
    16  B(5.9e-02) N            0.3296   0.4637   0.0000   0.0000  3.354070e-16  2.488447e-08
    17  B(6.5e-02) N            0.3352   0.4682   0.0000   0.0000  5.620295e-23  1.018430e-11
> znleqc
$x
[1] 1 1

$fvec
[1] -2.947198e-12  1.018430e-11

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 24

$njcnt
[1] 1

> 
> znleqd <- nleqslv(xstart, dslnex, global="pwldog",xscalm="auto",
+                     control=list(trace=1,btol=.01,delta=-1.0))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: single dogleg (initial trust region = -1)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda     Dlt0     Dltn         Fnorm   Largest |f|
     0                                           2.886812e+00  2.250000e+00
     1  N(2.2e-02) C            1.6418   3.2836  8.095340e-01  1.271042e+00
     2  B(3.9e-02) W   0.1281   3.2836   3.2836  4.095849e-01  7.531526e-01
     3  B(1.1e-01) N            3.0835   0.3084  3.017897e+02  2.342730e+01
     3             C            0.3084   0.6167  1.874296e-01  5.670768e-01
     4  B(9.5e-02) W   0.1260   0.6167   0.1925  3.540052e-01  6.639920e-01
     4             C            0.1925   0.3849  8.551739e-02  4.118982e-01
     5  B(8.3e-02) W   0.1231   0.3849   0.1012  1.699433e-01  5.068913e-01
     5             C            0.1012   0.2025  5.166772e-02  3.125842e-01
     6  B(7.6e-02) W   0.0729   0.2025   0.0798  5.954067e-02  3.438857e-01
     6             C            0.0798   0.1596  3.885292e-02  2.197599e-01
     7  B(7.1e-02) W   0.0679   0.1596   0.0223  5.759439e-02  3.387078e-01
     7             C            0.0223   0.0445  3.746529e-02  2.022319e-01
     8  B(6.7e-02) C            0.0445   0.0890  3.491455e-02  2.105077e-01
     9  B(6.6e-02) W   0.0485   0.0890   0.1780  3.023685e-02  1.794172e-01
     9             W   0.1302   0.1780   0.3561  2.514126e-02  1.592694e-01
     9             W   0.2915   0.3561   0.7121  1.647441e-02  1.460008e-01
     9             W   0.6131   0.7121   1.4243  9.585282e-03  1.366469e-01
    10  B(7.2e-02) N            0.3657   0.7314  2.812342e-04  2.226223e-02
    11  B(6.4e-02) N            0.0551   0.1102  1.015239e-06  1.246726e-03
    12  B(5.6e-02) N            0.0070   0.0070  3.449606e-07  8.128806e-04
    13  B(7.9e-02) N            0.0016   0.0032  6.453893e-09  1.115558e-04
    14  B(1.0e-01) N            0.0002   0.0004  4.195555e-13  8.966540e-07
    15  B(9.9e-02) N            0.0000   0.0000  2.649376e-17  7.148968e-09
> znleqd
$x
[1] 1 1

$fvec
[1] 1.371052e-09 7.148968e-09

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 23

$njcnt
[1] 1

> 
> znleqe <- nleqslv(xstart, dslnex, global="dbldog",xscalm="auto",
+                     control=list(trace=1,btol=.01,delta=-2.0))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: double dogleg (initial trust region = -2)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda    Gamma      Eta     Dlt0     Dltn         Fnorm   Largest |f|
     0                                                             2.886812e+00  2.250000e+00
     1  N(2.2e-02) N            0.9332   0.9465  18.9253   1.8925  5.787362e+05  1.070841e+03
     1             W   0.0527   0.9332   0.9465   1.8925   3.7851  2.157603e-01  6.426005e-01
     2  B(4.5e-02) W   0.8834   0.4939   0.5951   3.7851   0.3785  1.972145e+01  5.739738e+00
     2             C            0.4939   0.5951   0.3785   0.3785  1.396385e-01  4.731105e-01
     3  B(9.4e-02) C            0.3102   0.4482   0.3785   0.1886  1.398343e-01  3.830620e-01
     3             C            0.3102   0.4482   0.1886   0.1886  1.300754e-01  4.169268e-01
     4  B(6.0e-02) C            0.0322   0.2257   0.1886   0.3772  1.256638e-01  3.650524e-01
     4             W   0.0649   0.0322   0.2257   0.3772   0.7544  1.053499e-01  4.219073e-01
     5  B(1.3e-01) W   0.7111   0.0959   0.2767   0.7544   0.3530  1.085969e-01  4.546130e-01
     5             W   0.1944   0.0959   0.2767   0.3530   0.3530  9.578294e-02  4.159158e-01
     6  B(9.3e-02) W   0.1931   0.0538   0.2430   0.3530   0.0984  1.095236e-01  3.316415e-01
     6             C            0.0538   0.2430   0.0984   0.0984  9.360309e-02  3.853856e-01
     7  B(5.9e-02) C            0.0206   0.2164   0.0984   0.0235  9.628701e-02  3.955757e-01
     7             C            0.0206   0.2164   0.0235   0.0059  9.419914e-02  3.882021e-01
     7             C            0.0206   0.2164   0.0059   0.0059  9.374657e-02  3.861047e-01
     8  N(6.7e-02) N            0.3025   0.4420   7.7421   0.7742  2.226824e+04  2.078533e+02
     8             C            0.3025   0.4420   0.7742   0.0774  2.484812e-01  5.776054e-01
     8             C            0.3025   0.4420   0.0774   0.1548  9.210093e-02  3.775981e-01
     9  B(5.6e-02) C            0.1117   0.2894   0.1548   0.0590  9.306463e-02  3.790307e-01
     9             C            0.1117   0.2894   0.0590   0.0590  9.169252e-02  3.780372e-01
    10  B(2.2e-02) C            0.0126   0.2101   0.0590   0.0137  9.217460e-02  3.731092e-01
    10             C            0.0126   0.2101   0.0137   0.0060  9.170753e-02  3.768705e-01
    10             C            0.0126   0.2101   0.0060   0.0030  9.169247e-02  3.775312e-01
    11  B(3.3e-04) W   0.0000   0.0000   0.2000   0.0030   0.0030  9.170167e-02  3.780226e-01
    12  N(5.2e-03) N            0.0001   0.2001 117.7190  11.7719  3.486524e+11  8.350007e+05
    12             W   0.4996   0.0001   0.2001  11.7719   1.1772  3.513386e+05  8.335347e+02
    12             W   0.0498   0.0001   0.2001   1.1772   0.1177  6.968881e-01  1.091021e+00
    12             W   0.0048   0.0001   0.2001   0.1177   0.0118  9.309908e-02  3.740359e-01
    12             W   0.0002   0.0001   0.2001   0.0118   0.0118  9.168315e-02  3.750778e-01
    13  B(2.7e-03) W   0.0002   0.0000   0.2000   0.0118   0.0022  9.170867e-02  3.764058e-01
    13             C            0.0000   0.2000   0.0022   0.0022  9.168337e-02  3.757296e-01
    14  N(2.9e-03) N            0.0000   0.2000 207.8242  20.7824  1.055896e+13  4.595340e+06
    14             W   0.4999   0.0000   0.2000  20.7824   2.0782  1.058914e+07  4.593666e+03
    14             W   0.0499   0.0000   0.2000   2.0782   0.2078  1.663047e+01  4.945721e+00
    14             W   0.0049   0.0000   0.2000   0.2078   0.0208  9.917776e-02  3.802766e-01
    14             W   0.0004   0.0000   0.2000   0.0208   0.0038  9.172076e-02  3.762516e-01
    14             C            0.0000   0.2000   0.0038   0.0038  9.168106e-02  3.759724e-01
    15  B(2.4e-03) C            0.0000   0.2000   0.0038   0.0038  9.168204e-02  3.751748e-01
    16  N(6.4e-04) N            0.0000   0.2000 954.5028  95.4503  9.912199e+16  4.452456e+08
    16             W   0.5000   0.0000   0.2000  95.4503   9.5450  9.913487e+10  4.452367e+05
    16             W   0.0500   0.0000   0.2000   9.5450   0.9545  1.009541e+05  4.455160e+02
    16             W   0.0050   0.0000   0.2000   0.9545   0.0955  6.465997e-01  8.194839e-01
    16             W   0.0005   0.0000   0.2000   0.0955   0.0095  9.304137e-02  3.760354e-01
    16             W   0.0000   0.0000   0.2000   0.0095   0.0095  9.169106e-02  3.756345e-01
> znleqe
$x
[1]  1.485117475 -0.007008055

$fvec
[1]  0.2056230 -0.3756345

$termcd
[1] 3

$message
[1] "No better point found (algorithm has stalled)"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 44

$njcnt
[1] 5

> 
> znleqf <- nleqslv(xstart, dslnex, global="pwldog",xscalm="auto",
+                     control=list(trace=1,btol=.01,delta=-2.0))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: single dogleg (initial trust region = -2)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda     Dlt0     Dltn         Fnorm   Largest |f|
     0                                           2.886812e+00  2.250000e+00
     1  N(2.2e-02) N           18.9253   1.8925  5.787362e+05  1.070841e+03
     1             W   0.0494   1.8925   3.7851  2.157157e-01  6.426743e-01
     2  B(4.5e-02) W   0.5243   3.7851   0.3785  1.340718e+01  4.710634e+00
     2             C            0.3785   0.3785  1.410977e-01  4.765195e-01
     3  B(9.5e-02) C            0.3785   0.1837  1.427888e-01  3.894509e-01
     3             C            0.1837   0.1837  1.321456e-01  4.229527e-01
     4  B(5.8e-02) C            0.1837   0.3674  1.273076e-01  3.620894e-01
     5  B(5.8e-02) W   0.0015   0.3674   0.7349  9.232595e-02  3.923559e-01
     6  B(2.6e-01) C            0.7349   0.1286  2.224327e-01  6.508535e-01
     6             C            0.1286   0.0623  9.271892e-02  3.692277e-01
     6             C            0.0623   0.0312  9.186943e-02  3.813414e-01
     7  B(3.0e-02) C            0.0312   0.0078  9.235595e-02  3.889191e-01
     7             C            0.0078   0.0078  9.196318e-02  3.832594e-01
     8  N(2.5e-02) N           23.6459   2.3646  2.260017e+07  6.713640e+03
     8             W   0.0987   2.3646   0.2365  3.009611e+01  6.787391e+00
     8             W   0.0085   0.2365   0.0252  9.942757e-02  3.707432e-01
     8             C            0.0252   0.0505  9.170783e-02  3.752468e-01
     9  B(2.2e-02) C            0.0505   0.0173  9.187266e-02  3.796880e-01
     9             C            0.0173   0.0173  9.168399e-02  3.767646e-01
    10  B(5.4e-03) W   0.0001   0.0173   0.0039  9.172956e-02  3.744525e-01
    10             C            0.0039   0.0039  9.168409e-02  3.757663e-01
    11  N(2.1e-03) N          292.9951  29.2995  8.291623e+13  1.287748e+07
    11             W   0.1000  29.2995   2.9300  8.302500e+07  1.287431e+04
    11             W   0.0100   2.9300   0.2930  9.403951e+01  1.247458e+01
    11             W   0.0010   0.2930   0.0293  9.966302e-02  3.626056e-01
    11             W   0.0001   0.0293   0.0031  9.177119e-02  3.754955e-01
    11             C            0.0031   0.0063  9.168103e-02  3.757891e-01
    12  B(2.0e-03) C            0.0063   0.0063  9.168419e-02  3.755724e-01
    13  N(1.0e-03) N          585.1633  58.5163  5.262161e+15  1.025879e+08
    13             W   0.1000  58.5163   5.8516  5.263926e+09  1.025819e+05
    13             W   0.0100   5.8516   0.5852  5.462381e+03  1.021544e+02
    13             W   0.0010   0.5852   0.0585  1.276766e-01  4.253310e-01
    13             W   0.0001   0.0585   0.0059  9.208135e-02  3.750512e-01
    13             W   0.0000   0.0059   0.0059  9.168391e-02  3.751813e-01
> znleqf
$x
[1] 1.485396223 0.003501154

$fvec
[1]  0.2064142 -0.3751813

$termcd
[1] 3

$message
[1] "No better point found (algorithm has stalled)"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 34

$njcnt
[1] 4

> 
> znlejc <- nleqslv(xstart, dslnex, jacdsln, global="dbldog",xscalm="auto",
+                     control=list(trace=1,btol=.01,delta=-1.0))
  Algorithm parameters
  --------------------
  Method: Broyden  Global strategy: double dogleg (initial trust region = -1)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda    Gamma      Eta     Dlt0     Dltn         Fnorm   Largest |f|
     0                                                             2.886812e+00  2.250000e+00
     1  N(2.2e-02) C            0.9332   0.9465   1.6418   3.2836  8.095340e-01  1.271042e+00
     2  B(3.9e-02) W   0.1788   0.6549   0.7240   3.2836   6.5672  3.416215e-01  7.035984e-01
     3  B(1.1e-01) N            0.8312   0.8649   2.9936   0.2994  2.837331e+02  2.270049e+01
     3             C            0.8312   0.8649   0.2994   0.5987  1.352076e-01  4.965310e-01
     4  B(9.0e-02) W   0.2606   0.6553   0.7243   0.5987   0.0923  5.436290e-01  7.379608e-01
     4             C            0.6553   0.7243   0.0923   0.1846  8.813217e-02  4.157850e-01
     5  B(8.0e-02) C            0.5536   0.6429   0.1846   0.3692  3.647682e-02  2.245532e-01
     5             W   0.2009   0.5536   0.6429   0.3692   0.1846  3.647682e-02  2.245532e-01
     6  B(7.4e-02) W   0.3661   0.0385   0.2308   0.1846   0.0225  6.118723e-02  3.443445e-01
     6             C            0.0385   0.2308   0.0225   0.0449  3.451899e-02  1.901860e-01
     7  B(7.4e-02) C            0.0371   0.2296   0.0449   0.0224  3.451958e-02  2.339182e-01
     7             C            0.0371   0.2296   0.0224   0.0449  3.360690e-02  2.072956e-01
     8  B(6.0e-02) W   0.1156   0.0265   0.2212   0.0449   0.0898  3.097652e-02  1.986845e-01
     8             W   0.3080   0.0265   0.2212   0.0898   0.1796  2.960973e-02  2.150601e-01
     9  B(6.0e-02) W   0.7109   0.0624   0.2499   0.1796   0.3592  2.026895e-02  1.807498e-01
    10  B(6.0e-02) P            0.0736   0.2589   0.3592   0.7183  7.271833e-03  1.163476e-01
    10             P            0.0736   0.2589   0.7183   1.4366  3.514798e-03  6.857280e-02
    11  B(6.2e-02) N            0.9349   0.9479   0.0938   0.1877  3.775627e-05  7.609514e-03
    12  B(4.1e-02) N            0.0396   0.2317   0.0549   0.0549  1.422241e-05  5.224354e-03
    13  B(6.1e-02) N            0.4071   0.5257   0.0179   0.0359  5.978522e-08  3.425697e-04
    14  B(6.6e-02) N            0.4732   0.5786   0.0010   0.0021  2.705933e-12  2.069923e-06
    15  B(6.6e-02) N            0.0606   0.2485   0.0000   0.0000  4.036346e-14  2.727174e-07
    16  B(5.9e-02) N            0.3296   0.4637   0.0000   0.0000  3.353332e-16  2.488174e-08
    17  B(6.5e-02) N            0.3352   0.4682   0.0000   0.0000  5.621396e-23  1.018519e-11
> znlejc
$x
[1] 1 1

$fvec
[1] -2.947864e-12  1.018519e-11

$termcd
[1] 1

$message
[1] "Function criterion near zero"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 24

$njcnt
[1] 1

> 
> znlejd <- nleqslv(xstart, dslnex, jacdsln, global="dbldog",xscalm="auto",
+                     method="Newton", control=list(trace=1,btol=.01,delta=-1.0))
  Algorithm parameters
  --------------------
  Method: Newton  Global strategy: double dogleg (initial trust region = -1)
  Maximum stepsize = 1.79769e+308
  Scaling: automatic
  ftol = 1e-08 xtol = 1e-08 btol = 0.01

  Iteration report
  ----------------
  Iter         Jac     Lambda    Gamma      Eta     Dlt0     Dltn         Fnorm   Largest |f|
     0                                                             2.886812e+00  2.250000e+00
     1  N(2.2e-02) C            0.9332   0.9465   1.6418   3.2836  8.095340e-01  1.271042e+00
     2  N(5.5e-01) N            1.0000   1.0000   1.2800   2.5600  1.516910e-01  4.993966e-01
     3  N(5.4e-02) W   0.6306   0.3824   0.5059   2.5600   0.2560  1.504288e+01  3.997181e+00
     3             C            0.3824   0.5059   0.2560   0.5120  1.025512e-01  3.205660e-01
     4  N(7.2e-02) W   0.2325   0.1040   0.2832   0.5120   0.1393  1.275929e-01  3.658661e-01
     4             C            0.1040   0.2832   0.1393   0.2785  9.323588e-02  3.631542e-01
     5  N(5.8e-02) W   0.1068   0.0178   0.2143   0.2785   0.0890  9.731709e-02  3.759658e-01
     5             C            0.0178   0.2143   0.0890   0.1781  9.192858e-02  3.835269e-01
     6  N(2.5e-02) W   0.0315   0.0029   0.2023   0.1781   0.0306  9.515752e-02  3.711546e-01
     6             C            0.0029   0.2023   0.0306   0.0611  9.170992e-02  3.750015e-01
     7  N(1.2e-02) C            0.0019   0.2015   0.0611   0.0140  9.199469e-02  3.806940e-01
     7             C            0.0019   0.2015   0.0140   0.0140  9.168181e-02  3.762962e-01
     8  N(1.1e-03) W   0.0001   0.0000   0.2000   0.0140   0.0017  9.170196e-02  3.756097e-01
     8             C            0.0000   0.2000   0.0017   0.0034  9.168090e-02  3.757706e-01
     9  N(5.9e-04) W   0.0000   0.0000   0.2000   0.0034   0.0034  9.168180e-02  3.754950e-01
> znlejd
$x
[1]  1.485203157 -0.002069260

$fvec
[1]  0.2058327 -0.3754950

$termcd
[1] 3

$message
[1] "No better point found (algorithm has stalled)"

$scalex
[1] 4.836223 1.250000

$nfcnt
[1] 15

$njcnt
[1] 9

> 
